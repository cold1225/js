## 有做过前端加载优化相关的工作吗？都做过哪些努力？

一、做性能优化的目的是什么?

一些指标
1. 首屏时间
2. 首次可交互时间
3. 首次有意义的内容渲染时间

页面性能检测：https://developers.google.com/speed/pagespeed/insights/

polyfill: https://polyfill.io/v3/url-builder/

1. 只请求当前需要的资源

- 异步加载，懒加载，polyfill

2. 缩减资源体积
- 打包压缩 webpack4内置了对于代码的压缩功能 ugly、terser-plugin插件压缩html、css、js tree-shaking
- gzip node服务有开启gzip的方法 nginx gzip on
- 图片格式的优化，压缩 tinypng.com(免费压缩，80%) 根据屏幕分辨率展示不同分辨率的图片（一般是PC和移动端都需要的项目） webp
- 尽量控制cookie的大小 request header,cookie

3. 时序优化（通过代码去影响资源的加载）
- js promise.all
- ssr(可以做缓存，方便seo)
- prefetch, prerender, preload
<link rel="dns-prefetch" href="xxx1.com">
<link rel="dns-prefetch" href="xxx2.com">
<link rel="preconnect" href="xxx1.com">
<link rel="preload" as="image" href="https://aaa.com/p.png">

4. 合理利用缓存
- cdn  
cdn预热：cdn厂家不通过用户的访问而提前把源站的内容分发到全国各地的cdn节点上 
cdn刷新： 强制回源 拉取源站最新的资源
cdn域名为什么跟业务域名不一样?
douyin.com, cdn-douyi.com 防止携带业务cookie浪费资源


二、如果一段js执行时间非常长，怎么去分析
  装饰器
```js
function measure(target:any, name: string, descriptor: any) {
    const oldValue = descriptor.value
    descriptor.value = async function () {
        console.time(name)
        const ret = await oldValue.apply(this, arguments)
        console.timeEnd(name)
        return ret
    }
    return descriptor
}
```
三、阿里云oss支持通过链接后面拼参数来做图片的格式转换，尝试写一下，把任意图片转换为webp,需要注意什么？